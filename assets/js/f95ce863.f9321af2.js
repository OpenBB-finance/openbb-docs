"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[60054],{20891(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"workspace/developers/ai-features/create-html-artifacts","title":"Create HTML artifacts","description":"Stream inline HTML artifacts as part of your agent\'s response","source":"@site/content/workspace/developers/ai-features/create-html-artifacts.md","sourceDirName":"workspace/developers/ai-features","slug":"/workspace/developers/ai-features/create-html-artifacts","permalink":"/workspace/developers/ai-features/create-html-artifacts","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenBB-finance/openbb-docs/edit/main/content/workspace/developers/ai-features/create-html-artifacts.md","tags":[],"version":"current","lastUpdatedBy":"DidierRLopes","lastUpdatedAt":1769635752000,"sidebarPosition":7,"frontMatter":{"title":"Create HTML artifacts","sidebar_position":7,"description":"Stream inline HTML artifacts as part of your agent\'s response","keywords":["html","artifacts","visualization","custom rendering","SSE","widgets"]},"sidebar":"tutorialSidebar","previous":{"title":"Create charts","permalink":"/workspace/developers/ai-features/create-charts"},"next":{"title":"MCP tools integration","permalink":"/workspace/developers/ai-features/mcp-tools"}}');var r=n(74848),s=n(28453),a=n(94331);const d={title:"Create HTML artifacts",sidebar_position:7,description:"Stream inline HTML artifacts as part of your agent's response",keywords:["html","artifacts","visualization","custom rendering","SSE","widgets"]},o=void 0,c={},l=[{value:"Architecture",id:"architecture",level:2},{value:"Query flow",id:"query-flow",level:3},{value:"SSE event format",id:"sse-event-format",level:3},{value:"Core logic",id:"core-logic",level:2},{value:"Example templates",id:"example-templates",level:2},{value:"Metric cards",id:"metric-cards",level:3},{value:"Alert box",id:"alert-box",level:3},{value:"Security considerations",id:"security-considerations",level:2},{value:"Best practices",id:"best-practices",level:2}];function p(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.A,{title:"AI Features \u2014 Create HTML artifacts | OpenBB Workspace Docs"}),"\n",(0,r.jsxs)(t.p,{children:["Stream custom HTML content with ",(0,r.jsx)(t.code,{children:"html_artifact(...)"}),". HTML artifacts are rendered inline in the chat and can be converted to dashboard widgets by users."]}),"\n",(0,r.jsxs)(t.p,{children:["Reference implementation in ",(0,r.jsx)(t.a,{href:"https://github.com/OpenBB-finance/agents-for-openbb/tree/main/39-vanilla-agent-html-artifacts",children:"this GitHub repository"}),"."]}),"\n",(0,r.jsx)("img",{className:"pro-border-gradient",width:"800",alt:"Charts",src:"https://openbb-cms.directus.app/assets/e74e0b8e-3858-47e8-bcd6-d59dfe1cbfe7.png"}),"\n",(0,r.jsx)(t.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(t.p,{children:"Emit HTML artifacts so custom visualizations render below the answer. HTML content is sanitized with DOMPurify before rendering for security."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"agents.json"})," configuration:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'return JSONResponse(content={\n    "vanilla_agent_html": {\n        "name": "HTML Artifacts Agent",\n        "description": "An example agent that produces HTML artifacts rendered inline in the chat.",\n        "endpoints": {"query": "/v1/query"},\n        "features": {\n            "streaming": True,\n            "widget-dashboard-select": False,\n            "widget-dashboard-search": False,\n        },\n    }\n})\n'})}),"\n",(0,r.jsx)(t.h3,{id:"query-flow",children:"Query flow"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Process user request and prepare HTML content"}),"\n",(0,r.jsxs)(t.li,{children:["Stream explanatory text with ",(0,r.jsx)(t.code,{children:"message_chunk()"})]}),"\n",(0,r.jsx)(t.li,{children:"Create HTML content as a string (inline styles supported)"}),"\n",(0,r.jsxs)(t.li,{children:["Emit ",(0,r.jsx)(t.code,{children:"html_artifact()"})," events with proper configuration"]}),"\n",(0,r.jsx)(t.li,{children:"HTML renders inline below streamed content"}),"\n",(0,r.jsx)(t.li,{children:"Users can click widget icon to add artifacts to dashboard"}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"sse-event-format",children:"SSE event format"}),"\n",(0,r.jsx)(t.p,{children:"HTML artifacts are sent as SSE events with the following structure:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'{\n    "event": "copilotMessageArtifact",\n    "data": {\n        "type": "html",\n        "uuid": "unique-id",\n        "name": "artifact_name",\n        "description": "A description of the artifact",\n        "content": "<div>Your HTML content here</div>"\n    }\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"core-logic",children:"Core logic"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'import json\nimport uuid\nfrom typing import AsyncGenerator\nfrom openbb_ai import message_chunk\nfrom openbb_ai.models import QueryRequest\nfrom sse_starlette.sse import EventSourceResponse\n\ndef html_artifact(content: str, name: str, description: str) -> dict:\n    """\n    Create an HTML artifact SSE event.\n\n    Args:\n        content: The HTML content to render\n        name: A unique name for the artifact\n        description: A description of the artifact\n\n    Returns:\n        SSE event dict with type="html" artifact\n    """\n    return {\n        "event": "copilotMessageArtifact",\n        "data": json.dumps({\n            "type": "html",\n            "uuid": str(uuid.uuid4()),\n            "name": name,\n            "description": description,\n            "content": content,\n        }),\n    }\n\n# Example HTML template\nDASHBOARD_CARD_HTML = """\n<div style="font-family: system-ui, -apple-system, sans-serif; padding: 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; color: white; max-width: 400px;">\n  <h2 style="margin: 0 0 16px 0; font-size: 20px; font-weight: 600;">Portfolio Summary</h2>\n  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">\n    <div style="background: rgba(255,255,255,0.15); padding: 16px; border-radius: 12px;">\n      <div style="font-size: 28px; font-weight: bold;">$124.5K</div>\n      <div style="font-size: 13px; opacity: 0.8; margin-top: 4px;">Total Value</div>\n    </div>\n    <div style="background: rgba(255,255,255,0.15); padding: 16px; border-radius: 12px;">\n      <div style="font-size: 28px; font-weight: bold; color: #4ade80;">+12.3%</div>\n      <div style="font-size: 13px; opacity: 0.8; margin-top: 4px;">Today\'s Change</div>\n    </div>\n  </div>\n</div>\n"""\n\n@app.post("/v1/query")\nasync def query(request: QueryRequest) -> EventSourceResponse:\n    async def execution_loop() -> AsyncGenerator[dict, None]:\n        client = openai.AsyncOpenAI()\n\n        # Stream the LLM response\n        async for event in await client.chat.completions.create(\n            model="gpt-4o",\n            messages=openai_messages,\n            stream=True,\n        ):\n            if chunk := event.choices[0].delta.content:\n                yield message_chunk(chunk).model_dump()\n\n        # Emit HTML artifact\n        yield message_chunk("\\n\\nHere\'s a portfolio dashboard card:\\n\\n").model_dump()\n        yield html_artifact(\n            content=DASHBOARD_CARD_HTML,\n            name="portfolio_dashboard",\n            description="A portfolio summary dashboard card",\n        )\n\n        yield message_chunk(\n            "\\n\\nYou can click the widget icon to add this to your dashboard!"\n        ).model_dump()\n\n    return EventSourceResponse(\n        content=execution_loop(),\n        media_type="text/event-stream",\n    )\n'})}),"\n",(0,r.jsx)(t.h2,{id:"example-templates",children:"Example templates"}),"\n",(0,r.jsx)(t.h3,{id:"metric-cards",children:"Metric cards"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-html",children:'<div style="font-family: system-ui, -apple-system, sans-serif; display: flex; gap: 16px; flex-wrap: wrap;">\n  <div style="background: #f8fafc; border: 1px solid #e2e8f0; padding: 20px; border-radius: 12px; min-width: 140px;">\n    <div style="color: #64748b; font-size: 13px; margin-bottom: 8px;">Revenue</div>\n    <div style="font-size: 24px; font-weight: 600; color: #0f172a;">$2.4M</div>\n    <div style="color: #22c55e; font-size: 13px; margin-top: 4px;">\u2191 14.2%</div>\n  </div>\n  <div style="background: #f8fafc; border: 1px solid #e2e8f0; padding: 20px; border-radius: 12px; min-width: 140px;">\n    <div style="color: #64748b; font-size: 13px; margin-bottom: 8px;">Users</div>\n    <div style="font-size: 24px; font-weight: 600; color: #0f172a;">48.2K</div>\n    <div style="color: #22c55e; font-size: 13px; margin-top: 4px;">\u2191 8.1%</div>\n  </div>\n</div>\n'})}),"\n",(0,r.jsx)(t.h3,{id:"alert-box",children:"Alert box"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-html",children:'<div style="font-family: system-ui, -apple-system, sans-serif; background: #fef3c7; border: 1px solid #f59e0b; border-radius: 12px; padding: 16px; display: flex; gap: 12px; align-items: flex-start; max-width: 500px;">\n  <div style="background: #f59e0b; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: bold;">!</div>\n  <div>\n    <div style="font-weight: 600; color: #92400e; margin-bottom: 4px;">Market Alert</div>\n    <div style="color: #a16207; font-size: 14px; line-height: 1.5;">Unusual trading volume detected in AAPL. Volume is 3.2x higher than the 20-day average.</div>\n  </div>\n</div>\n'})}),"\n",(0,r.jsx)(t.h2,{id:"security-considerations",children:"Security considerations"}),"\n",(0,r.jsx)(t.p,{children:"The frontend sanitizes all HTML with DOMPurify before rendering. Keep the following in mind:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Element/Attribute"}),(0,r.jsx)(t.th,{children:"Status"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"<script>"})," tags"]}),(0,r.jsx)(t.td,{children:"Stripped"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"<style>"})," tags"]}),(0,r.jsx)(t.td,{children:"Stripped"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"<iframe>"}),", ",(0,r.jsx)(t.code,{children:"<form>"}),", ",(0,r.jsx)(t.code,{children:"<object>"}),", ",(0,r.jsx)(t.code,{children:"<embed>"})]}),(0,r.jsx)(t.td,{children:"Stripped"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"on*"})," event handlers (onclick, onload, etc.)"]}),(0,r.jsx)(t.td,{children:"Stripped"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Inline styles"}),(0,r.jsx)(t.td,{children:"Supported"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Standard HTML elements (div, span, img, etc.)"}),(0,r.jsx)(t.td,{children:"Supported"})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"best-practices",children:"Best practices"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Use inline styles for all styling (external stylesheets not supported)"}),"\n",(0,r.jsx)(t.li,{children:"Keep HTML self-contained with no external dependencies"}),"\n",(0,r.jsx)(t.li,{children:"Use system fonts for consistent cross-platform rendering"}),"\n",(0,r.jsx)(t.li,{children:"Test artifacts at different viewport sizes for responsiveness"}),"\n",(0,r.jsxs)(t.li,{children:["Provide meaningful ",(0,r.jsx)(t.code,{children:"name"})," and ",(0,r.jsx)(t.code,{children:"description"})," for widget creation"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},28453(e,t,n){n.d(t,{R:()=>a,x:()=>d});var i=n(96540);const r={},s=i.createContext(r);function a(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:t},e.children)}},94331(e,t,n){n.d(t,{A:()=>s});n(96540);var i=n(5260),r=n(74848);function s({title:e}){return(0,r.jsx)(i.A,{children:(0,r.jsx)("title",{children:e})})}}}]);