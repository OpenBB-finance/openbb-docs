"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[12742],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var i=t(96540);const a={},s=i.createContext(a);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},39068:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var i=t(27143),a=t(74848);function s(e){let{title:n}=e;return(0,a.jsx)(i.A,{children:(0,a.jsx)("title",{children:n})})}},75608:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"workspace/data-widgets/live-grid","title":"Live Grid","description":"Create a real-time data grid widget for OpenBB Workspace that displays live updates in a table format","source":"@site/content/workspace/data-widgets/live-grid.md","sourceDirName":"workspace/data-widgets","slug":"/workspace/data-widgets/live-grid","permalink":"/workspace/data-widgets/live-grid","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenBB-finance/openbb-docs/edit/main/content/workspace/data-widgets/live-grid.md","tags":[],"version":"current","lastUpdatedBy":"Andrew","lastUpdatedAt":1747487561000,"sidebarPosition":16,"frontMatter":{"title":"Live Grid","sidebar_position":16,"description":"Create a real-time data grid widget for OpenBB Workspace that displays live updates in a table format","keywords":["live grid","real-time data","websocket","streaming data","data table","live updates"]},"sidebar":"tutorialSidebar","previous":{"title":"TradingView Charts","permalink":"/workspace/data-widgets/tradingview-charts"},"next":{"title":"Newsfeed","permalink":"/workspace/data-widgets/newsfeed"}}');var a=t(74848),s=t(28453),o=t(39068);const r={title:"Live Grid",sidebar_position:16,description:"Create a real-time data grid widget for OpenBB Workspace that displays live updates in a table format",keywords:["live grid","real-time data","websocket","streaming data","data table","live updates"]},d=void 0,l={},c=[{value:"Step 1: Set Up Your Project",id:"step-1-set-up-your-project",level:2},{value:"Step 2: Create the Live Feed Endpoints",id:"step-2-create-the-live-feed-endpoints",level:2},{value:"Edit the widgets.json File",id:"edit-the-widgetsjson-file",level:3},{value:"Step 3: Run the Application",id:"step-3-run-the-application",level:2},{value:"Step 4: Add to OpenBB Pro",id:"step-4-add-to-openbb-pro",level:2},{value:"Additional Resources",id:"additional-resources",level:2}];function p(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{title:"Live Grid | OpenBB Workspace Docs"}),"\n",(0,a.jsx)(n.p,{children:"This guide will walk you through the process of creating a live grid widget for OpenBB Workspace. By the end of this guide, you will have a working live grid widget that can display real-time data updates for a table. The live grid widget can be configured to only update certain cells when their values change or all of the cells."}),"\n",(0,a.jsx)(n.h2,{id:"step-1-set-up-your-project",children:"Step 1: Set Up Your Project"}),"\n",(0,a.jsx)(n.p,{children:"To get started, create the main application file and the widget configuration file. You will only need these two files:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"main.py"}),": This file will contain your FastAPI application code."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"widgets.json"}),": This file will define the configuration for your widget."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["The backend will use the same FastAPI setup and structure as described in the ",(0,a.jsx)(n.a,{href:"/content/workspace/data-integration#1-create-the-api-server.md",children:"Overview"})," page."]}),"\n",(0,a.jsx)(n.h2,{id:"step-2-create-the-live-feed-endpoints",children:"Step 2: Create the Live Feed Endpoints"}),"\n",(0,a.jsxs)(n.p,{children:["Edit the ",(0,a.jsx)(n.code,{children:"main.py"})," file and add the following code. This sets up both a REST endpoint for initial data and a WebSocket endpoint for live updates:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from fastapi import APIRouter, WebSocket, WebSocketDisconnect, HTTPException\nfrom fastapi.websockets import WebSocketState\nimport numpy as np\nimport asyncio\nfrom typing import List\nfrom datetime import datetime\n\n\n# Sample data store\nWS_DATA = {\n    "AAPL": {\n        "price": 150.0,\n        "prev_close": 145.54,\n        "volume": 1000000,\n        "change": 4.46,\n        "change_percent": 0.03,\n    },\n    # ... other symbols ...\n}\n\ndef get_ws_data(symbol: str):\n    """Generate real-time data for a symbol"""\n    data = WS_DATA.get(symbol, {"price": 100.0, "prev_close": 100.0, "volume": 1000000})\n    \n    price = data["price"] + np.random.uniform(-10, 10)\n    volume = data["volume"] + np.random.randint(100, 1000)\n    change = price - data["prev_close"]\n    change_percent = change / data["prev_close"]\n    \n    WS_DATA[symbol].update(dict(price=price, volume=volume))\n    \n    return {\n        "symbol": symbol,\n        "price": price,\n        "change": change,\n        "change_percent": change_percent,\n        "volume": volume,\n    }\n\n# Live Feed Initial Data Endpoint (This sets the initial data for the widget + allows Copilot to grab the data)\n@app.get("/test_websocket")\ndef test_websocket(symbol: str):\n    """Initial data endpoint"""\n    symbols = symbol.split(",")\n    return [\n        {\n            "date": datetime.now().date(),\n            **get_ws_data(symbol),\n            "market_cap": np.random.randint(1000000000, 2000000000),\n        }\n        for symbol in symbols\n    ]\n\n# Live Feed WebSocket Endpoint\n@app.websocket("/ws")\nasync def websocket_endpoint(websocket: WebSocket):\n    """WebSocket endpoint for live updates"""\n    await websocket.accept()\n    try:\n        await websocket_handler(websocket)\n    except WebSocketDisconnect:\n        return\n    except Exception as e:\n        await websocket.close(code=1011)\n        raise HTTPException(status_code=500, detail=str(e))\n\n# Sample WebSocket Handler\nasync def websocket_handler(websocket: WebSocket):\n    subbed_symbols: set[str] = set()\n\n    async def consumer_handler(ws: WebSocket):\n        try:\n            async for data in ws.iter_json():\n                if symbols := data.get("params", {}).get("symbol"):\n                    if isinstance(symbols, str):\n                        symbols = symbols.split(",")\n\n                    subbed_symbols.clear()\n                    subbed_symbols.update(set(symbols))\n\n        except WebSocketDisconnect:\n            pass\n        except RuntimeError:\n            await ws.close()\n\n    async def producer_handler(ws: WebSocket):\n        try:\n            while websocket.client_state != WebSocketState.DISCONNECTED:\n                current_symbols = list(subbed_symbols)\n                np.random.shuffle(current_symbols)\n\n                for symbol in current_symbols:\n                    await ws.send_json(get_ws_data(symbol))\n                    await asyncio.sleep(np.random.uniform(0.5, 0.8))\n\n                await asyncio.sleep(np.random.uniform(0.1, 0.3))\n\n        except WebSocketDisconnect:\n            pass\n        except RuntimeError:\n            await ws.close()\n\n    consumer_task = asyncio.create_task(consumer_handler(websocket))\n    producer_task = asyncio.create_task(producer_handler(websocket))\n\n    done, pending = await asyncio.wait(\n        [consumer_task, producer_task], return_when=asyncio.FIRST_COMPLETED\n    )\n\n    for task in pending:\n        task.cancel()\n'})}),"\n",(0,a.jsx)(n.h3,{id:"edit-the-widgetsjson-file",children:"Edit the widgets.json File"}),"\n",(0,a.jsxs)(n.p,{children:["Open the ",(0,a.jsx)(n.code,{children:"widgets.json"})," file and add the following configuration:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "live_grid_example": {\n    "name": "Live Grid",\n    "description": "Live Grid",\n    "type": "live_grid",\n    "endpoint": "test_websocket",\n    "wsEndpoint": "ws",\n    "data": {\n      "wsRowIdColumn": "symbol",\n      "table": {\n        "showAll": true,\n        "columnsDefs": [\n          {\n            "field": "symbol",\n            "headerName": "Symbol"\n          },\n          {\n            "field": "price",\n            "headerName": "Price",\n            "renderFn": "showCellChange",\n            "renderFnParams": {\n              "colorValueKey": "change"\n            }\n          },\n          {\n            "field": "change_percent",\n            "headerName": "Change %",\n            "renderFn": "greenRed"\n          },\n          {\n            "field": "volume",\n            "enableCellChangeWs": false,\n            "headerName": "Volume"\n          }\n        ]\n      }\n    },\n    "params": [\n      {\n        "paramName": "symbol",\n        "description": "The symbol to get details for",\n        "value": "TSLA",\n        "label": "Symbol",\n        "type": "text",\n        "multiSelect": true,\n        "options": [\n          {"label": "AAPL", "value": "AAPL"},\n          {"label": "GOOGL", "value": "GOOGL"},\n          {"label": "MSFT", "value": "MSFT"},\n          {"label": "AMZN", "value": "AMZN"},\n          {"label": "TSLA", "value": "TSLA"}\n        ]\n      }\n    ],\n    "gridData": {\n      "w": 20,\n      "h": 9\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"A few key points:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.code,{children:"endpoint"})," is the endpoint that will be used to get the initial data for the widget."]}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.code,{children:"wsEndpoint"})," is the endpoint that will be used to get the live updates for the widget."]}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.code,{children:"enableCellChangeWs"})," is a boolean that will be used to determine if the cell change will be sent over the WebSocket. Use this to prevent the cell from being updated over the WebSocket. By default, it is set to ",(0,a.jsx)(n.code,{children:"true"})," for fields that are sent in the websocket and appear in the data. The only field that is special here is the ",(0,a.jsx)(n.code,{children:"wsRowIdColumn"})," which is the column that will be used to identify the row."]}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.code,{children:"wsRowIdColumn"})," is the column that will be used to identify the row. This is important to set correctly to ensure the live updates are displayed correctly. This the key between your ws and the initial data."]}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.code,{children:"renderFn"})," is the function that will be used to render the cell. You can find more information on the ",(0,a.jsx)(n.a,{href:"/workspace/widget-configuration/render-functions",children:"Render Functions"})," page. In our case we are using a custom function ",(0,a.jsx)(n.code,{children:"showCellChange"})," to display the change in price and providing the key to use."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"step-3-run-the-application",children:"Step 3: Run the Application"}),"\n",(0,a.jsx)(n.p,{children:"Start the FastAPI Server using Uvicorn. This will host your backend locally:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"uvicorn main:app --host localhost --port 5050\n"})}),"\n",(0,a.jsx)(n.h2,{id:"step-4-add-to-openbb-pro",children:"Step 4: Add to OpenBB Pro"}),"\n",(0,a.jsxs)(n.p,{children:["Navigate to ",(0,a.jsx)(n.a,{href:"https://pro.openbb.co/app",children:"OpenBB Pro Apps"})," and add your backend by clicking on the ",(0,a.jsx)(n.code,{children:"Manage Backends"})," button in the top right corner. Select ",(0,a.jsx)(n.code,{children:"Add Backend"})," and fill in the details. Your URL will be ",(0,a.jsx)(n.code,{children:"http://localhost:5050"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Once you have added your backend, you can find the widget in the default category with the name ",(0,a.jsx)(n.code,{children:"Live Grid"}),". The widget will display real-time price updates for the selected symbols."]}),"\n",(0,a.jsx)("img",{className:"pro-border-gradient",width:"600",alt:"live-feed",src:"https://openbb-assets.s3.us-east-1.amazonaws.com/docs/pro/live_grid.png"}),"\n",(0,a.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,a.jsxs)(n.p,{children:["You can find more examples of how to set up your own backend in the ",(0,a.jsx)(n.a,{href:"https://github.com/OpenBB-finance/backend-examples-for-openbb-workspace",children:"Backend for OpenBB Workspace GitHub"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);