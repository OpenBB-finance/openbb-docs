"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[74045],{9535:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"workspace/developers/widget-types/file-viewer","title":"File Viewer","description":"Guide to using PDF and multi-PDF viewer widgets in OpenBB Workspace","source":"@site/content/workspace/developers/widget-types/file-viewer.md","sourceDirName":"workspace/developers/widget-types","slug":"/workspace/developers/widget-types/file-viewer","permalink":"/workspace/developers/widget-types/file-viewer","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenBB-finance/openbb-docs/edit/main/content/workspace/developers/widget-types/file-viewer.md","tags":[],"version":"current","lastUpdatedBy":"DidierRLopes","lastUpdatedAt":1764279336000,"sidebarPosition":6,"frontMatter":{"title":"File Viewer","sidebar_position":6,"description":"Guide to using PDF and multi-PDF viewer widgets in OpenBB Workspace","keywords":["widgets","pdf","file viewer","base64","multi-file viewer"]},"sidebar":"tutorialSidebar","previous":{"title":"Metric","permalink":"/workspace/developers/widget-types/metric"},"next":{"title":"AgGrid Table Charts","permalink":"/workspace/developers/widget-types/aggrid-table-charts"}}');var a=t(74848),s=t(28453),r=t(39068);const o={title:"File Viewer",sidebar_position:6,description:"Guide to using PDF and multi-PDF viewer widgets in OpenBB Workspace",keywords:["widgets","pdf","file viewer","base64","multi-file viewer"]},l=void 0,p={},d=[{value:"Single File",id:"single-file",level:2},{value:"PDF Widget with Base64",id:"pdf-widget-with-base64",level:3},{value:"PDF Widget with URL",id:"pdf-widget-with-url",level:3},{value:"Multi File Viewer",id:"multi-file-viewer",level:2},{value:"Multi File Viewer with Base64",id:"multi-file-viewer-with-base64",level:3},{value:"Multi File Viewer with URL",id:"multi-file-viewer-with-url",level:3},{value:"Multi File Viewer with Category Filtering",id:"multi-file-viewer-with-category-filtering",level:2}];function f(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{title:"File Viewer | OpenBB Workspace Docs"}),"\n",(0,a.jsx)(n.h2,{id:"single-file",children:"Single File"}),"\n",(0,a.jsx)(n.p,{children:"The (multi) file viewer widget supports two methods for serving files:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Base64 Encoding: The file content is encoded in base64 and sent directly in the response."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"URL Reference: A URL to the file is provided, which can be a presigned URL for secure access to files stored in cloud storage."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The endpoint should return a JSON response with the following structure:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "headers": {\n    "Content-Type": "application/json"\n  },\n  "data_format": {\n    "data_type": "pdf",\n    "filename": "example.pdf"\n  },\n  "content": "base64_encoded_content",  // For base64 method\n  // OR\n  "file_reference": "https://example.com/path/to/file.pdf"  // For URL method\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Note:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"data_format.data_type"}),': The type of file (e.g., "pdf", "csv", "txt")']}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"data_format.filename"}),": The name of the file to display"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"content"}),": Base64-encoded file content (for base64 method)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"file_reference"}),": URL to the file (for URL method)"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"pdf-widget-with-base64",children:"PDF Widget with Base64"}),"\n",(0,a.jsx)(n.p,{children:"A widget that displays a PDF file using base64 encoding. This method is useful for displaying PDFs directly in the workspace."}),"\n",(0,a.jsx)("img",{className:"pro-border-gradient",width:"800",alt:"PDF Widget with Base64 Example",src:"https://openbb-cms.directus.app/assets/9e202a65-eb71-4e43-b111-5f5c79dfa6dc.png"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'@register_widget({\n    "name": "PDF Widget with Base64",\n    "description": "Display a PDF file with base64 encoding",\n    "endpoint": "pdf_widget_base64",\n    "gridData": {\n        "w": 20,\n        "h": 20\n    },\n    "type": "pdf",\n})\n@app.get("/pdf_widget_base64")\ndef get_pdf_widget_base64():\n    """Serve a file through base64 encoding."""\n    try:\n        name = "sample.pdf"\n        with open(ROOT_PATH / name, "rb") as file:\n            file_data = file.read()\n            encoded_data = base64.b64encode(file_data)\n            content = encoded_data.decode("utf-8")\n    \n    except FileNotFoundError as exc:\n        raise HTTPException(\n            status_code=404,\n            detail="File not found"\n        ) from exc\n    \n    return JSONResponse(\n        headers={"Content-Type": "application/json"},\n        content={\n            "data_format": {\n                "data_type": "pdf",\n                "filename": name,\n            },\n            "content": content,\n        },\n    )\n'})}),"\n",(0,a.jsx)(n.h3,{id:"pdf-widget-with-url",children:"PDF Widget with URL"}),"\n",(0,a.jsx)(n.p,{children:"A widget that displays a PDF file using a direct URL. This method is more efficient for larger PDFs as it doesn't require base64 encoding."}),"\n",(0,a.jsx)("img",{className:"pro-border-gradient",width:"800",alt:"PDF Widget with URL Example",src:"https://openbb-cms.directus.app/assets/7d4fc0e6-f458-49a1-9be9-161d2bec1886.png"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'@register_widget({\n    "name": "PDF Widget with URL",\n    "description": "Display a PDF file",\n    "type": "pdf", \n    "endpoint": "pdf_widget_url",\n    "gridData": {\n        "w": 20,\n        "h": 20\n    },\n})\n@app.get("/pdf_widget_url")\ndef get_pdf_widget_url():\n    """Serve a file through URL."""\n    file_reference = "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/sample.pdf"\n    if not file_reference:\n        raise HTTPException(status_code=404, detail="File not found")\n    return JSONResponse(\n        headers={"Content-Type": "application/json"},\n        content={\n            "data_format": {\n                "data_type": "pdf",\n                "filename": "Sample.pdf",\n            },\n            "url": file_reference,\n        },\n    )\n'})}),"\n",(0,a.jsx)(n.h2,{id:"multi-file-viewer",children:"Multi File Viewer"}),"\n",(0,a.jsx)(n.h3,{id:"multi-file-viewer-with-base64",children:"Multi File Viewer with Base64"}),"\n",(0,a.jsx)(n.p,{children:"A widget that displays multiple PDF files using base64 encoding. This method is useful for smaller files that you want to serve directly (vs URL)."}),"\n",(0,a.jsx)("img",{className:"pro-border-gradient",width:"800",alt:"Multi PDF Viewer with Base64 Example",src:"https://openbb-cms.directus.app/assets/610ec2bc-2768-4d48-9f0b-0ad08a69b41e.png"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from pydantic import BaseModel\nfrom typing import List, Union\nfrom fastapi import Body\n\nclass FileOption(BaseModel):\n    label: str\n    value: str\n\nclass FileDataFormat(BaseModel):\n    data_type: str\n    filename: str\n\nclass DataContent(BaseModel):\n    content: str\n    data_format: FileDataFormat\n\nclass DataUrl(BaseModel):\n    url: str\n    data_format: FileDataFormat\n\nclass DataError(BaseModel):\n    error_type: str\n    content: str\n\n# Sample PDF files data\nSAMPLE_PDFS = [\n    {\n        "name": "Sample",\n        "location": "sample.pdf",\n        "url": "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/sample.pdf",\n    },\n    {\n        "name": "Bitcoin Whitepaper", \n        "location": "bitcoin.pdf",\n        "url": "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/bitcoin.pdf",\n    }\n]\n\n# Options endpoint for file selection\n@app.get("/get_pdf_options")\nasync def get_pdf_options() -> List[FileOption]:\n    """Get list of available PDFs"""\n    return [\n        FileOption(label=pdf["name"], value=pdf["name"]) \n        for pdf in SAMPLE_PDFS\n    ]\n\n@register_widget({\n    "name": "Multi PDF Viewer - Base64",\n    "description": "View multiple PDF files using base64 encoding",\n    "type": "multi_file_viewer",\n    "endpoint": "/multi_pdf_base64",\n    "gridData": {\n        "w": 20,\n        "h": 10\n    },\n    "params": [\n        {\n            "paramName": "pdf_name",\n            "description": "PDF file to display",\n            "type": "endpoint",\n            "label": "PDF File",\n            "optionsEndpoint": "/get_pdf_options",\n            "show": False,\n            "value": ["Bitcoin Whitepaper"],\n            "multiSelect": True,\n            "roles": ["fileSelector"]\n        }\n    ]\n})\n@app.post("/multi_pdf_base64")\nasync def get_multi_pdf_base64(\n    pdf_name: List[str] = Body(..., embed=True)\n) -> List[Union[DataContent, DataError]]:\n    """Get multiple PDF files in base64 format"""\n    files = []\n    for name in pdf_name:\n        pdf = next((p for p in SAMPLE_PDFS if p["name"] == name), None)\n        if not pdf:\n            files.append(\n                DataError(\n                    error_type="not_found", \n                    content=f"PDF \'{name}\' not found"\n                ).model_dump()\n            )\n            continue\n\n        file_path = ROOT_PATH / pdf["location"]\n        if not file_path.exists():\n            files.append(\n                DataError(\n                    error_type="not_found",\n                    content=f"PDF file \'{pdf[\'location\']}\' not found on disk"\n                ).model_dump()\n            )\n            continue\n\n        with open(file_path, "rb") as file:\n            base64_content = base64.b64encode(file.read()).decode("utf-8")\n            files.append(\n                DataContent(\n                    content=base64_content,\n                    data_format=FileDataFormat(\n                        data_type="pdf",\n                        filename=f"{pdf[\'name\']}.pdf"\n                    )\n                ).model_dump()\n            )\n\n    return JSONResponse(\n        headers={"Content-Type": "application/json"},\n        content=files\n    )\n'})}),"\n",(0,a.jsx)(n.h3,{id:"multi-file-viewer-with-url",children:"Multi File Viewer with URL"}),"\n",(0,a.jsx)(n.p,{children:"A widget that displays multiple PDF files using URLs. This method is more efficient for larger files as they're loaded directly from the URL."}),"\n",(0,a.jsx)("img",{className:"pro-border-gradient",width:"800",alt:"Multi PDF Viewer with URL Example",src:"https://openbb-cms.directus.app/assets/7d4fc0e6-f458-49a1-9be9-161d2bec1886.png"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from pydantic import BaseModel\nfrom typing import List, Union\nfrom fastapi import Body\n\nclass FileOption(BaseModel):\n    label: str\n    value: str\n\nclass FileDataFormat(BaseModel):\n    data_type: str\n    filename: str\n\nclass DataContent(BaseModel):\n    content: str\n    data_format: FileDataFormat\n\nclass DataUrl(BaseModel):\n    url: str\n    data_format: FileDataFormat\n\nclass DataError(BaseModel):\n    error_type: str\n    content: str\n\n@register_widget({\n    "name": "Multi PDF Viewer - URL",\n    "description": "View multiple PDF files using URLs",\n    "type": "multi_file_viewer", \n    "endpoint": "/multi_pdf_url",\n    "gridData": {\n        "w": 20,\n        "h": 10\n    },\n    "params": [\n        {\n            "paramName": "pdf_name",\n            "description": "PDF file to display",\n            "type": "endpoint",\n            "label": "PDF File",\n            "optionsEndpoint": "/get_pdf_options",\n            "value": ["Sample"],\n            "show": False,\n            "multiSelect": True,\n            "roles": ["fileSelector"]\n        }\n    ]\n})\n@app.post("/multi_pdf_url")\nasync def get_multi_pdf_url(\n    pdf_name: List[str] = Body(..., embed=True)\n) -> List[Union[DataUrl, DataError]]:\n    """Get multiple PDF files via URLs"""\n    files = []\n    for name in pdf_name:\n        pdf = next((p for p in SAMPLE_PDFS if p["name"] == name), None)\n        if not pdf:\n            files.append(\n                DataError(\n                    error_type="not_found",\n                    content=f"PDF \'{name}\' not found"\n                ).model_dump()\n            )\n            continue\n\n        if url := pdf.get("url"):\n            files.append(\n                DataUrl(\n                    url=url,\n                    data_format=FileDataFormat(\n                        data_type="pdf",\n                        filename=f"{pdf[\'name\']}.pdf"\n                    )\n                ).model_dump()\n            )\n        else:\n            files.append(\n                DataError(\n                    error_type="not_found",\n                    content=f"URL not found for \'{name}\'"\n                ).model_dump()\n            )\n\n    return JSONResponse(\n        headers={"Content-Type": "application/json"},\n        content=files\n    )\n'})}),"\n",(0,a.jsx)(n.h2,{id:"multi-file-viewer-with-category-filtering",children:"Multi File Viewer with Category Filtering"}),"\n",(0,a.jsxs)(n.p,{children:["This multi-file-viewer widget introduces a parameter called ",(0,a.jsx)(n.code,{children:"optionsParams"})," which allows you to pass the options to an endpoint from a different parameter. More information ",(0,a.jsx)(n.a,{href:"/workspace/developers/widget-parameters/dependent-dropdown",children:"here"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["In our case we want to pass the options in the ",(0,a.jsx)(n.code,{children:"type"})," parameter to the ",(0,a.jsx)(n.code,{children:"/whitepapers/options"})," endpoint to filter the list of whitepapers."]}),"\n",(0,a.jsx)("img",{className:"pro-border-gradient",width:"600",alt:"multi-file-viewer",src:"https://openbb-assets.s3.us-east-1.amazonaws.com/docs/pro/multi-file-viewer.png"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from pydantic import BaseModel\nfrom typing import List, Union\nfrom fastapi import Body\n\nclass FileOption(BaseModel):\n    label: str\n    value: str\n\nclass FileDataFormat(BaseModel):\n    data_type: str\n    filename: str\n\nclass DataContent(BaseModel):\n    content: str\n    data_format: FileDataFormat\n\nclass DataUrl(BaseModel):\n    url: str\n    data_format: FileDataFormat\n\nclass DataError(BaseModel):\n    error_type: str\n    content: str\n\n# Sample whitepaper data with categories\nWHITEPAPERS = [\n    {\n        "name": "Bitcoin",\n        "location": "bitcoin.pdf",\n        "url": "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/bitcoin.pdf",\n        "category": "l1",\n    },\n    {\n        "name": "Ethereum",\n        "location": "ethereum.pdf",\n        "url": "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/ethereum.pdf",\n        "category": "l1",\n    },\n    {\n        "name": "Chainlink",\n        "location": "chainlink.pdf",\n        "url": "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/chainlink.pdf",\n        "category": "oracles",\n    },\n    {\n        "name": "Solana",\n        "location": "solana.pdf",\n        "url": "https://openbb-assets.s3.us-east-1.amazonaws.com/testing/solana.pdf",\n        "category": "l1",\n    },\n]\n\n@app.get("/whitepapers/options")\nasync def get_whitepaper_options(category: str = Query("all")) -> List[FileOption]:\n    """Get list of available whitepapers filtered by category"""\n    if category == "all":\n        return [\n            FileOption(label=wp["name"], value=wp["name"])\n            for wp in WHITEPAPERS\n        ]\n    return [\n        FileOption(label=wp["name"], value=wp["name"])\n        for wp in WHITEPAPERS\n        if wp["category"] == category\n    ]\n\n@register_widget({\n    "name": "Whitepapers",\n    "description": "A collection of crypto whitepapers.",\n    "type": "multi_file_viewer",\n    "endpoint": "/whitepapers/view-base64",\n    "gridData": {\n        "w": 40,\n        "h": 10\n    },\n    "params": [\n        {\n            "type": "endpoint",\n            "paramName": "whitepaper",\n            "value": ["Bitcoin"],\n            "label": "Whitepaper",\n            "description": "Whitepaper to display.",\n            "optionsEndpoint": "/whitepapers/options",\n            "show": False,\n            "optionsParams": {\n                "category": "$category"\n            },\n            "multiSelect": True,\n            "roles": ["fileSelector"]\n        },\n        {\n            "type": "text",\n            "paramName": "category",\n            "value": "all",\n            "label": "Category",\n            "description": "Category of whitepaper to fetch.",\n            "options": [\n                {\n                    "label": "All",\n                    "value": "all"\n                },\n                {\n                    "label": "L1",\n                    "value": "l1"\n                },\n                {\n                    "label": "L2",\n                    "value": "l2"\n                },\n                {\n                    "label": "Oracles",\n                    "value": "oracles"\n                },\n                {\n                    "label": "Defi",\n                    "value": "defi"\n                }\n            ]\n        }\n    ]\n})\n@app.post("/whitepapers/view-base64")\nasync def view_whitepapers_base64(\n    whitepaper: List[str] = Body(..., embed=True),\n) -> List[Union[DataContent, DataError]]:\n    """Get multiple whitepapers in base64 format"""\n    files = []\n    for name in whitepaper:\n        wp = next((w for w in WHITEPAPERS if w["name"] == name), None)\n        if not wp:\n            files.append(\n                DataError(\n                    error_type="not_found",\n                    content=f"Whitepaper \'{name}\' not found"\n                ).model_dump()\n            )\n            continue\n\n        file_path = ROOT_PATH / wp["location"]\n        if file_path.exists():\n            with open(file_path, "rb") as file:\n                base64_content = base64.b64encode(file.read()).decode("utf-8")\n                files.append(\n                    DataContent(\n                        content=base64_content,\n                        data_format=FileDataFormat(\n                            data_type="pdf", \n                            filename=f"{wp[\'name\']}.pdf"\n                        ),\n                    ).model_dump()\n                )\n        else:\n            files.append(\n                DataError(\n                    error_type="not_found", \n                    content="Whitepaper file not found"\n                ).model_dump()\n            )\n    return JSONResponse(headers={"Content-Type": "application/json"}, content=files)\n\n# Alternative URL version\n@app.post("/whitepapers/view-url")\nasync def view_whitepapers_url(\n    whitepaper: List[str] = Body(..., embed=True),\n) -> List[Union[DataUrl, DataError]]:\n    """Get multiple whitepapers via URLs"""\n    files = []\n    for name in whitepaper:\n        wp = next((w for w in WHITEPAPERS if w["name"] == name), None)\n        if not wp:\n            files.append(\n                DataError(\n                    error_type="not_found",\n                    content=f"Whitepaper \'{name}\' not found"\n                ).model_dump()\n            )\n            continue\n            \n        if url := wp.get("url"):\n            files.append(\n                DataUrl(\n                    url=url,\n                    data_format=FileDataFormat(\n                        data_type="pdf",\n                        filename=f"{wp[\'name\']}.pdf"\n                    ),\n                ).model_dump()\n            )\n        else:\n            files.append(\n                DataError(\n                    error_type="not_found",\n                    content=f"URL not found for \'{name}\'"\n                ).model_dump()\n            )\n    return JSONResponse(headers={"Content-Type": "application/json"}, content=files)\n'})}),"\n",(0,a.jsxs)(n.p,{children:["More examples can be found on the github repository at ",(0,a.jsx)(n.a,{href:"https://github.com/OpenBB-finance/backends-for-openbb",children:"https://github.com/OpenBB-finance/backends-for-openbb"})]})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(f,{...e})}):f(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(96540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}},39068:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var i=t(27143),a=t(74848);function s(e){let{title:n}=e;return(0,a.jsx)(i.A,{children:(0,a.jsx)("title",{children:n})})}}}]);