"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[56807],{28453(e,n,o){o.d(n,{R:()=>s,x:()=>d});var r=o(96540);const t={},i=r.createContext(t);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}},72553(e,n,o){o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"odp/python/developer/extension_types/router","title":"Router Extensions","description":"This page provides information about how to write router extensions for the OpenBB Python Package.","source":"@site/content/odp/python/developer/extension_types/router.md","sourceDirName":"odp/python/developer/extension_types","slug":"/odp/python/developer/extension_types/router","permalink":"/odp/python/developer/extension_types/router","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenBB-finance/openbb-docs/edit/main/content/odp/python/developer/extension_types/router.md","tags":[],"version":"current","lastUpdatedBy":"Meghan Lopes","lastUpdatedAt":1770054700000,"sidebarPosition":1,"frontMatter":{"title":"Router Extensions","sidebar_position":1,"description":"This page provides information about how to write router extensions for the OpenBB Python Package.","keywords":["ODP","Router","API","MCP","OBBject","Python","Development","OpenBB Platform","extensions","how-to"]},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/odp/python/developer/extension_types/"},"next":{"title":"From FastAPI","permalink":"/odp/python/developer/extension_types/from_fastapi"}}');var t=o(74848),i=o(28453),s=o(94331);const d={title:"Router Extensions",sidebar_position:1,description:"This page provides information about how to write router extensions for the OpenBB Python Package.",keywords:["ODP","Router","API","MCP","OBBject","Python","Development","OpenBB Platform","extensions","how-to"]},a=void 0,c={},l=[{value:"Folder structure",id:"folder-structure",level:2},{value:"TOML File",id:"toml-file",level:3},{value:"Imports",id:"imports",level:2},{value:"Provider Interface Imports",id:"provider-interface-imports",level:3},{value:"Endpoints",id:"endpoints",level:2},{value:"Provider Interface",id:"provider-interface",level:3},{value:"Basic - GET",id:"basic---get",level:3},{value:"Basic - POST",id:"basic---post",level:3},{value:"Decorator Parameters",id:"decorator-parameters",level:3},{value:"Using <code>fastapi.APIRouter</code>",id:"using-fastapiapirouter",level:3}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:o}=n;return o||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.A,{title:"Build Router Extensions - Developer | OpenBB Docs"}),"\n",(0,t.jsx)(n.p,{children:"A router extension refers to API endpoints, paths, and the namespaces within the Python Interface.\nThey are the exposed, user-facing, functions and power all of the interfaces - REST API, MCP, Notebook, etc."}),"\n",(0,t.jsxs)(n.p,{children:["Under the hood, router extension modules are instances of ",(0,t.jsx)(n.code,{children:"fastapi.APIRouter"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"folder-structure",children:"Folder structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"router_example\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 openbb_empty_router\n\u2502   \u2514\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 empty_router.py\n\u251c\u2500\u2500 poetry.lock\n\u2514\u2500\u2500 pyproject.toml\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Extension code will go in the ",(0,t.jsx)(n.code,{children:"empty_router.py"})," file, and ",(0,t.jsx)(n.code,{children:"__init__.py"})," contains no code."]}),"\n",(0,t.jsx)(n.h3,{id:"toml-file",children:"TOML File"}),"\n",(0,t.jsx)(n.p,{children:"The entry point for the extension is specified as a Poetry plugin, near the bottom of the file."}),"\n",(0,t.jsxs)(o,{children:[(0,t.jsxs)("summary",{mdxType:"summary",children:[(0,t.jsx)(n.code,{children:"pyproject.toml"})," "]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'[tool.poetry]\nname = "openbb-empty-router"\nversion = "0.0.0"\ndescription = "An empty OpenBB Router extension"\nauthors = ["Hello <hello@world.com>"]\nreadme = "README.md"\npackages = [{ include = "openbb_empty_router" }]\n\n[tool.poetry.dependencies]\npython = "^3.10,<3.14"\nopenbb-core = "*"\n\n[build-system]\nrequires = ["poetry-core"]\nbuild-backend = "poetry.core.masonry.api"\n\n[tool.poetry.plugins."openbb_core_extension"]\nempty = "openbb_empty_router.empty_router:router"\n'})})]}),"\n",(0,t.jsx)(n.h2,{id:"imports",children:"Imports"}),"\n",(0,t.jsx)(n.p,{children:"Here's how to import the Router class, and initialize it."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from openbb_core.app.model.obbject import OBBject\nfrom openbb_core.app.router import Router\n\nrouter = Router(prefix="", description="An Empty OpenBB Router Extension.")\n'})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.p,{children:["The prefix will be determined by ",(0,t.jsx)(n.code,{children:"pyproject.toml"})]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'[tool.poetry.plugins."openbb_core_extension"]\nempty = "openbb_empty_router.empty_router:router"\n'})}),(0,t.jsxs)(n.p,{children:["Router commands will be available under the namepsace, ",(0,t.jsx)(n.code,{children:"obb.empty"})]})]}),"\n",(0,t.jsx)(n.h3,{id:"provider-interface-imports",children:"Provider Interface Imports"}),"\n",(0,t.jsxs)(n.p,{children:["Routing an endpoint to the ",(0,t.jsx)(n.a,{href:"/odp/python/developer/extension_types/provider",children:"Provider Interface"})," requires other imports, and a distinct function signature."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from openbb_core.app.model.command_context import CommandContext\nfrom openbb_core.app.model.example import APIEx, PythonEx\nfrom openbb_core.app.model.obbject import OBBject\nfrom openbb_core.app.provider_interface import (\n    ExtraParams,\n    ProviderChoices,\n    StandardParams,\n)\nfrom openbb_core.app.query import Query\n"})}),"\n",(0,t.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"Router"})," instance is applied as a decorator, using ",(0,t.jsx)(n.code,{children:"@router.command"}),".\nThere are two varities of endpoint, and endpoint's path will be the name of the function."]}),"\n",(0,t.jsx)(n.h3,{id:"provider-interface",children:"Provider Interface"}),"\n",(0,t.jsx)(n.p,{children:"To implement a Provider metamodel, define the function as:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# This uses the Provider Interface to call the empty provider fetcher.\n@router.command(\n    model="Empty", # This is the metamodel defined in the Provider\'s `fetcher_dict`.\n    examples=[\n        APIEx(parameters={"provider": "empty"}),\n        PythonEx(\n            description="Say Hello.",\n            code=[\n                "result = obb.empty.hello()",\n            ],\n        ),\n    ],\n)\nasync def empty_function(\n    cc: CommandContext,\n    provider_choices: ProviderChoices,\n    standard_params: StandardParams,\n    extra_params: ExtraParams,\n) -> OBBject:\n    """An empty function using the Provider Interface."""\n    return await OBBject.from_query(Query(**locals()))\n'})}),"\n",(0,t.jsx)(n.h3,{id:"basic---get",children:"Basic - GET"}),"\n",(0,t.jsx)(n.p,{children:"A basic endpoint, where all business logic occurs within, will look like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# This is a standard router "get" command.\n@router.command(methods=["GET"])\nasync def hello() -> (\n    OBBject[str]\n):\n    """OpenBB Hello World."""\n    return OBBject(results="Hello from the Empty Router extension!")\n'})}),"\n",(0,t.jsx)(n.h3,{id:"basic---post",children:"Basic - POST"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from openbb_core.provider.abstract.data import Data\n\n# This is a standard router "post" command.\n@router.command(methods=["POST"])\nasync def hello(\n  data: Data,  # Body parameter\n  some_param: str  # Query parameter\n) -> OBBject:\n    """OpenBB Hello World."""\n    return OBBject(results=data.model_dump())\n'})}),"\n",(0,t.jsx)(n.h3,{id:"decorator-parameters",children:"Decorator Parameters"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"@router.command"})," decorator will accept:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"methods"})}),": List of HTTP methods - typically ",(0,t.jsx)(n.code,{children:"GET"})," or ",(0,t.jsx)(n.code,{children:"POST"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"model"})}),": A metamodel associated with a ",(0,t.jsx)(n.a,{href:"/odp/python/developer/extension_types/provider",children:(0,t.jsx)(n.code,{children:"Provider"})})," extension endpoint."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"deprecated"})}),": Instance of ",(0,t.jsx)(n.a,{href:"/odp/python/developer/how-to/deprecating_endpoints",children:(0,t.jsx)(n.code,{children:"Deprecated"})}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"examples"})}),": List of API or Python ",(0,t.jsx)(n.a,{href:"/odp/python/developer/how-to/examples",children:"Examples"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"exclude_from_api"})}),": Include endpoint only in Python Interface."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"no_validate"})}),": Set as ",(0,t.jsx)(n.code,{children:"True"})," to ",(0,t.jsx)(n.a,{href:"/odp/python/developer/how-to/disabling_output_validation",children:"ignore response validation"})," and treat as ",(0,t.jsx)(n.code,{children:"Any"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"openapi_extra"})}),": Dictionary of additional metadata to include in ",(0,t.jsx)(n.code,{children:"openapi.json"}),".","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use this as an entrypoint for inline configurations of ",(0,t.jsx)(n.a,{href:"/odp/python/extensions/interface/openbb-api",children:(0,t.jsx)(n.code,{children:"widget_config"})})," or ",(0,t.jsx)(n.a,{href:"/odp/python/extensions/interface/openbb-mcp",children:(0,t.jsx)(n.code,{children:"mcp_config"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"using-fastapiapirouter",children:["Using ",(0,t.jsx)(n.code,{children:"fastapi.APIRouter"})]}),"\n",(0,t.jsxs)(n.p,{children:["The instance of ",(0,t.jsx)(n.code,{children:"fastapi.APIRouter"})," can be accessed from the ",(0,t.jsx)(n.code,{children:"router._api_router"})," attribute, and can be used directly as a normal, FastAPI, decorator."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'@router._api_router.get("/also_empty")\nasync def also_empty(param: str) -> str:\n    """Also Emmpty"""\n    return "Hello world!"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},94331(e,n,o){o.d(n,{A:()=>i});o(96540);var r=o(5260),t=o(74848);function i({title:e}){return(0,t.jsx)(r.A,{children:(0,t.jsx)("title",{children:e})})}}}]);