"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[16643],{28453(e,n,t){t.d(n,{R:()=>s,x:()=>a});var r=t(96540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}},46235(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"odp/python/developer/extension_types/charting","title":"Charting Extensions","description":"This page is a guide for adding custom views to any router endpoint that are included with the response object when the user sets `chart=True`.","source":"@site/content/odp/python/developer/extension_types/charting.md","sourceDirName":"odp/python/developer/extension_types","slug":"/odp/python/developer/extension_types/charting","permalink":"/odp/python/developer/extension_types/charting","draft":false,"unlisted":false,"editUrl":"https://github.com/OpenBB-finance/openbb-docs/edit/main/content/odp/python/developer/extension_types/charting.md","tags":[],"version":"current","lastUpdatedBy":"Danglewood","lastUpdatedAt":1771262401000,"sidebarPosition":5,"frontMatter":{"title":"Charting Extensions","sidebar_position":5,"description":"This page is a guide for adding custom views to any router endpoint that are included with the response object when the user sets `chart=True`.","keywords":["OBBject","Python","Development","OpenBB Platform","extensions","obbject extension","how-to","charting","Plotly","openbb-charting"]},"sidebar":"tutorialSidebar","previous":{"title":"OBBject Plugins","permalink":"/odp/python/developer/extension_types/plugins"},"next":{"title":"How-To","permalink":"/odp/python/developer/how-to/"}}');var i=t(74848),o=t(28453),s=t(94331);const a={title:"Charting Extensions",sidebar_position:5,description:"This page is a guide for adding custom views to any router endpoint that are included with the response object when the user sets `chart=True`.",keywords:["OBBject","Python","Development","OpenBB Platform","extensions","obbject extension","how-to","charting","Plotly","openbb-charting"]},l=void 0,d={},c=[{value:"Folder structure",id:"folder-structure",level:2},{value:"TOML File",id:"toml-file",level:3},{value:"Writing the Extension",id:"writing-the-extension",level:3},{value:"**Kwargs",id:"kwargs",level:2},{value:"Conveying Parameters",id:"conveying-parameters",level:2},{value:"Usage",id:"usage",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.A,{title:"Charting Extensions - Developer | OpenBB Docs"}),"\n",(0,i.jsxs)(n.p,{children:["This page is a guide for adding custom views to any router endpoint,\nincluded with the response object when the user sets ",(0,i.jsx)(n.code,{children:"chart=True"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"The infrastructure is generally compatible with any JSON serializable object,\nbut some handling and helpers are optimized for Plotly Figure objects."}),"\n",(0,i.jsx)(n.h2,{id:"folder-structure",children:"Folder structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"obbject_example\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 openbb_empty_charting\n\u2502   \u2514\u2500\u2500 __init__.py\n\u251c\u2500\u2500 poetry.lock\n\u2514\u2500\u2500 pyproject.toml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Extension code can go directly in the ",(0,i.jsx)(n.code,{children:"__init__.py"})," file."]}),"\n",(0,i.jsx)(n.h3,{id:"toml-file",children:"TOML File"}),"\n",(0,i.jsx)(n.p,{children:"The entry point for the extension is specified as a Poetry plugin, near the bottom of the file."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",children:'[tool.poetry.plugins."openbb_charting_extension"]\nempty = "openbb_empty_charting:EmptyViews"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Where ",(0,i.jsx)(n.code,{children:"EmptyViews"})," is a class with static methods for each endpoint being implemented."]}),"\n",(0,i.jsxs)(n.p,{children:["A complete ",(0,i.jsx)(n.code,{children:"pyproject.toml"})," looks something like:"]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{mdxType:"summary",children:(0,i.jsx)(n.code,{children:"pyproject.toml"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",children:'[tool.poetry]\nname = "openbb-empty-charting"\nversion = "0.0.1"\ndescription = "An empty OBBject extension"\nauthors = ["Hello <hello@world.co>"]\nreadme = "README.md"\npackages = [{ include = "openbb_empty_charting" }]\n\n[tool.poetry.dependencies]\npython = "^3.10,<3.14"\nopenbb-core = "*"\nopenbb-charting = "*"\n\n[build-system]\nrequires = ["poetry-core"]\nbuild-backend = "poetry.core.masonry.api"\n\n[tool.poetry.plugins."openbb_charting_extension"]\nempty = "openbb_empty_charting:EmptyViews"\n'})})]}),"\n",(0,i.jsxs)(n.admonition,{type:"important",children:[(0,i.jsx)(n.p,{children:"Extension logic will map routers, and while not necessary to define as a dependency,\nit is assumed that routers for specific endpoints are installed in the environment."}),(0,i.jsxs)(n.p,{children:["For example, ",(0,i.jsx)(n.code,{children:"openbb-equity"})," should be installed if mapping to, ",(0,i.jsx)(n.code,{children:"obb.equity.price.quote"}),"."]}),(0,i.jsxs)(n.p,{children:["To not rely on ",(0,i.jsx)(n.code,{children:"openbb-charting"}),", add the plugin definition to a ",(0,i.jsx)(n.a,{href:"/odp/python/developer/extension_types/router",children:"Router extension"}),".\nThis has the effect of making the extension optional, because endpoint views will only be accessible when ",(0,i.jsx)(n.code,{children:"openbb-charting"})," is installed."]})]}),"\n",(0,i.jsx)(n.h3,{id:"writing-the-extension",children:"Writing the Extension"}),"\n",(0,i.jsxs)(n.p,{children:["In this example the extension code all lives inside ",(0,i.jsx)(n.code,{children:"__init__.py"}),"."]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["The example below uses ",(0,i.jsx)(n.a,{href:"/odp/python/developer/extension_types/router",children:(0,i.jsx)(n.code,{children:"openbb-empty-router"})})," as the router extension."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:">>> from openbb import obb\n\n>>> obb.empty.hello()\n\nOBBject[T]\n\nid: 068fa8b2-968c-7059-8000-e6a8e3501eba\nresults: Hello from the Empty Router extension!\nprovider: None\nwarnings: None\nchart: None\nextra: {'metadata': {'arguments': {'provider_choices': {}, 'standard_params': {}, '...\n"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"**kwargs"})," should be the only argument for the function."]}),"\n",(0,i.jsx)(n.li,{children:"Functions should be static methods of the target entry point."}),"\n",(0,i.jsxs)(n.li,{children:["Response types can be:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"openbb_core.app.model.charts.chart.Chart"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"openbb_charting.core.openbb_figure.OpenBBFigure | plotly.graph_objects.Figure | Any"})}),"\n",(0,i.jsx)(n.li,{children:"dict-like represention of the chart"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"tuple[<figure-object>, <JSON-serializable-content>]"})}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{mdxType:"summary",children:"Example Extension"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'"""Empty Router Views."""\n\nclass EmptyViews:\n    """Empty Views."""\n\n    @staticmethod\n    def empty_hello( # Map to any full router path like this, i.e, `etf_countries`\n        **kwargs,\n    ):\n        """Empty Hello World Chart.\n\n        Parameters\n        ----------\n        some_param: int\n            This parameter is now under kwargs["extra_params"]["some_param"]\n        """\n        # pylint: disable=import-outside-toplevel\n\n        # Import modules here instead of at the top of the file.\n        # This prevents circular imports and decouples from application initialization.\n\n\n        # This is an object that can be used to return the results.\n        # It accepts "fig", "content", and "format" as inputs.\n        # Content is the JSON serialized representation returned to the API,\n        # "fig" is the Python object holding the chart. \n        from openbb_core.app.model.charts.chart import Chart\n\n\n        # This is the general purpose Figure object,\n        # it is a subclass of plotly.graph_objects.Figure\n        # It can be used to display content in a dedicated window\n        # when `pywry` is installed from PyPI.\n        from openbb_charting.core.openbb_figure import OpenBBFigure\n        \n        # Code will execute when router endpoint is called, and `chart=True`.\n\n        print(kwargs)\n\n        fig = OpenBBFigure()\n        fig.add_bar(\n            x=["A", "B", "C"], y=[1, 2, 3]\n        )\n        fig.update_layout(\n            title="Hello Chart!",\n            template="plotly_dark"\n        )\n        return Chart(\n            fig=fig,  # Binary figure object\n            content=fig.to_plotly_json(),  # JSON-econdable version.\n            format="plotly"  # For user reference.\n        )\n'})})]}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{mdxType:"summary",children:"This results in:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:">>> res = obb.empty.hello(chart=True, some_param= 2)\n{\n    'extra_params': {'some_param': 2}, # Additional keyword arguments.\n    'obbject_item': 'Hello from the Empty Router extension!',  # This is the function's results object.\n    'charting_settings': {\"chart_style\": \"dark\", \"table_style\": \"dark\", ... }  # Portion of the user_settings.json\n    'standard_params': {},  # Main keyword arguments.\n    'provider': None,\n    'extra': {}  # The \n}\n\n>>> res\n\nOBBject[T]\n\nid: 068fac1e-e9fe-7037-8000-b993cc3e848f\nresults: Hello from the Empty Router extension!\nprovider: None\nwarnings: None\nchart: {'content': {'data': [{'x': ['A', 'B', 'C'], 'y': [1, 2, 3], 'type': 'bar'}]...\nextra: {'metadata': {'arguments': {'provider_choices': {}, 'standard_params': {}, '...\n"})})]}),"\n",(0,i.jsx)(n.h2,{id:"kwargs",children:"**Kwargs"}),"\n",(0,i.jsx)(n.p,{children:"Kwargs is a dictionary with the function's results, user settings, and execution metadata."}),"\n",(0,i.jsxs)(n.p,{children:["Implemented methods intercept the execution before completion, and returning sets the ",(0,i.jsx)(n.code,{children:"chart"})," attribute in the ",(0,i.jsx)(n.code,{children:"OBBject"})," response object."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"dict_keys(\n    [\n        'obbject_item', 'charting_settings', 'standard_params', 'extra_params', 'provider', 'extra'\n    ]\n)\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'kwargs["obbject_item"]'})}),": The validated 'results' object in the final output."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'kwargs["charting_settings"]'})}),": ",(0,i.jsx)(n.a,{href:"/odp/python/settings/user_settings/preferences",children:"User settings"})," are passed in for handling, if required."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'kwargs["standard_params"]'})}),": Parameters handled by the standard model, if any."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'kwargs["extra_params"]'})}),": All other parameters passed to the main function."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'kwargs["extra"]'})}),": ",(0,i.jsx)(n.a,{href:"/odp/python/developer/how-to/annotated_results",children:"Metadata"})," returned by a ",(0,i.jsx)(n.a,{href:"/odp/python/developer/extension_types/provider",children:"provider extension"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"conveying-parameters",children:"Conveying Parameters"}),"\n",(0,i.jsx)(n.p,{children:"If chart generation is being parameterized, the best thing to do is include them in the main function definition.\nHowever, it may not be possible - or desired - to add more definitions to the endpoint code."}),"\n",(0,i.jsxs)(n.p,{children:["The docstring is available in the Python Interface with the ",(0,i.jsx)(n.code,{children:"openbb-charting"})," method, ",(0,i.jsx)(n.code,{children:"get_params"}),". This calls Python ",(0,i.jsx)(n.code,{children:"help"})," on the function."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'>>> res = obb.empty.hello(chart=True, some_param= 2)\n>>> res.charting.get_params()\n\nHelp on function empty_hello in module openbb_empty_charting:\n\nempty_hello(**kwargs)\n    Empty Hello World Chart.\n\n    Parameters\n    ----------\n    some_param: int\n        This parameter is now under kwargs["extra_params"]["some_param"]\n'})}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsxs)(n.p,{children:["See the documentation ",(0,i.jsx)(n.a,{href:"/odp/python/extensions/infrastructure/openbb-charting",children:"here"})," for usage instructions and examples."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},94331(e,n,t){t.d(n,{A:()=>o});t(96540);var r=t(5260),i=t(74848);function o({title:e}){return(0,i.jsx)(r.A,{children:(0,i.jsx)("title",{children:e})})}}}]);